"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const vendor_controller_1 = require("../controllers/vendor.controller");
const auth_middleware_1 = require("../middleware/auth.middleware");
const authorize_middleware_1 = require("../middleware/authorize.middleware");
const upload_middleware_1 = require("../middleware/upload.middleware");
const router = (0, express_1.Router)();
const vendorController = new vendor_controller_1.VendorController();
console.log('üîÄ === VENDOR ROUTES REGISTRATION ===');
router.use(auth_middleware_1.authenticate);
const SUPER_ADMIN_ONLY = ['super_admin'];
const VENDOR_MANAGEMENT = ['super_admin', 'vendor_admin'];
const READ_ACCESS = ['super_admin', 'vendor_admin', 'ops_manager', 'finance_manager', 'warehouse_manager', 'warehouse_manager_full'];
console.log('üìã Registering company routes...');
router.post('/companies', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendor_controller_1.VendorController.createCompany);
router.get('/companies', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendor_controller_1.VendorController.getAllCompanies);
router.get('/companies/search', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendor_controller_1.VendorController.searchCompanies);
router.get('/companies/:cin', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendor_controller_1.VendorController.getCompanyById);
router.put('/companies/:cin', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendor_controller_1.VendorController.updateCompany);
router.delete('/companies/:cin', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendor_controller_1.VendorController.deleteCompany);
router.get('/companies/:cin/exists', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendor_controller_1.VendorController.checkCompanyExists);
router.get('/companies/:cin/vendors', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendor_controller_1.VendorController.getCompanyWithVendorStats);
console.log('üìä Registering dashboard routes...');
router.get('/common-dashboard', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.getCommonDashboard.bind(vendorController));
router.get('/super-admin/vendor-management', (0, authorize_middleware_1.authorize)(SUPER_ADMIN_ONLY), vendorController.getSuperAdminVendorManagement.bind(vendorController));
console.log('üëë Registering super admin routes...');
router.get('/super-admin/vendors', (0, authorize_middleware_1.authorize)(SUPER_ADMIN_ONLY), vendorController.getAllVendorsForSuperAdmin.bind(vendorController));
router.get('/super-admin/statistics', (0, authorize_middleware_1.authorize)(SUPER_ADMIN_ONLY), vendorController.getVendorStatistics.bind(vendorController));
router.get('/super-admin/pending-approvals', (0, authorize_middleware_1.authorize)(SUPER_ADMIN_ONLY), vendorController.getPendingApprovals.bind(vendorController));
console.log('‚úÖ Registering verification routes...');
router.patch('/:id/verify', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.updateVendorVerification.bind(vendorController));
router.post('/bulk-verify', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.bulkUpdateVendorVerification.bind(vendorController));
router.put('/:id/quick-verify', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.quickVerifyOrRejectVendor.bind(vendorController));
router.put('/:id/quick-reject', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.quickVerifyOrRejectVendor.bind(vendorController));
console.log('‚ûï Registering vendor creation routes...');
router.post('/create', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.createCompleteVendor.bind(vendorController));
router.post('/bulk-create', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.createBulkVendors.bind(vendorController));
console.log('üìù Registering general vendor routes...');
router.get('/profile/me', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.getMyVendorProfile.bind(vendorController));
router.get('/', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getAllVendors.bind(vendorController));
router.get('/:id', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getVendorById.bind(vendorController));
router.get('/vendor-id/:vendorId', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getVendorByVendorId.bind(vendorController));
router.put('/:id', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.updateVendor.bind(vendorController));
router.delete('/:id', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.deleteVendor.bind(vendorController));
console.log('üìÑ Registering document routes...');
router.post('/:id/documents', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), upload_middleware_1.uploadSingle, vendorController.uploadVendorDocument.bind(vendorController));
router.get('/:id/documents', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getVendorDocuments.bind(vendorController));
router.get('/:id/documents/:documentId', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getVendorDocument.bind(vendorController));
router.delete('/:id/documents/:documentId', (0, authorize_middleware_1.authorize)(VENDOR_MANAGEMENT), vendorController.deleteVendorDocument.bind(vendorController));
console.log('üìú Registering audit trail routes...');
router.get('/:id/audit-trail', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getVendorAuditTrail.bind(vendorController));
router.get('/companies/:cin/audit-trail', (0, authorize_middleware_1.authorize)(READ_ACCESS), vendorController.getCompanyAuditTrail.bind(vendorController));
console.log('‚úÖ === ALL VENDOR ROUTES REGISTERED ===');
exports.default = router;
